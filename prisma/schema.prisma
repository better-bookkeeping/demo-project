generator client {
  provider = "prisma-client"
  output   = "./generated/client"
}

datasource db {
  provider = "postgresql"
}

model User {
  id           String     @id @default(uuid())
  email        String     @unique
  name         String?
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  passwordHash String
  weights      Weight[]
  workouts     Workout[]
  movements    Movement[]
}

model Weight {
  id         String   @id @default(uuid())
  userId     String
  user       User     @relation(fields: [userId], references: [id])
  value      Float
  recordedAt DateTime @default(now())

  @@index([userId, recordedAt])
}

model Movement {
  id           String  @id @default(uuid())
  userId       String
  user         User    @relation(fields: [userId], references: [id])
  name         String
  isBodyWeight Boolean @default(false)
  sets         Set[]

  @@index([userId])
}

model Workout {
  userId      String
  user        User      @relation(fields: [userId], references: [id])
  id          String    @id @default(uuid())
  completedAt DateTime?
  sets        Set[]
}

model Set {
  id         String   @id @default(uuid())
  workoutId  String
  workout    Workout  @relation(fields: [workoutId], references: [id])
  movementId String
  movement   Movement @relation(fields: [movementId], references: [id])
  reps       Int
  weight     Float
}
